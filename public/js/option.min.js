(function(e){"use strict";var t=e.fn.addClass;e.fn.addClass=function(){var e=t.apply(this,arguments);if(this.prop("tagName")=="BODY"&&arguments[0]=="folded"){calculatePositionAndSize()}return e};var n=e.fn.removeClass;e.fn.removeClass=function(){var e=n.apply(this,arguments);if(this.prop("tagName")=="BODY"&&arguments[0]=="folded"){calculatePositionAndSize()}return e};var r=e.browser.msie;var i=0;if(r){i=jQuery.browser.version;i=parseFloat(i)}vp.custom_check_radio_event(".vp-wrap",".vp-field.vp-checked-field .field .input label");e(document).on("ready",function(){vp.init_controls(e(".vp-wrap"))});var s=[];var o=[];var u=[];var a=[];var f;e(".vp-menu-goto").each(function(t){var n=e(this).attr("href"),r=e(n),i=[];r.children(".vp-field").each(function(t){var n=e(this),r=n.attr("id"),s=n.attr("data-vp-validation"),l=n.attr("data-vp-bind"),c=n.attr("data-vp-items-bind"),h=n.getDatas().type,p=e('[name="'+r+'"]');f=n.attr("data-vp-dependency");f&&a.push({dep:f,type:"field",source:n.attr("id")});l&&o.push({bind:l,type:h,source:r});c&&u.push({bind:c,type:h,source:r});s&&i.push({name:r,rules:s,type:h})});r.children(".vp-section").each(function(t){var n=e(this);f=n.attr("data-vp-dependency");f&&a.push({dep:f,type:"section",source:n.attr("id")});n.find(".vp-field").each(function(t){var n=e(this),r=n.attr("id"),s=n.attr("data-vp-validation"),l=n.attr("data-vp-bind"),c=n.attr("data-vp-items-bind"),h=n.getDatas().type,p=e('[name="'+r+'"]');f=n.attr("data-vp-dependency");f&&a.push({dep:f,type:"field",source:n.attr("id")});l&&o.push({bind:l,type:h,source:r});c&&u.push({bind:c,type:h,source:r});s&&i.push({name:r,rules:s,type:h})})});if(i.length>0)s.push({name:n.trimChar("#"),fields:i})});e(".vp-js-menu-goto").click(function(t){t.preventDefault();window.location.hash="#_"+e(this).attr("href").substr(1);var n=e(this),r=n.parent("li"),i=r.parents("li"),s=r.siblings("li"),o=i.siblings("li"),u=e(n.attr("href"));s.removeClass("vp-current");o.removeClass("vp-current");i.addClass("vp-current");r.addClass("vp-current");u.siblings(".vp-panel").removeClass("vp-current");u.addClass("vp-current")});var l=window.location.hash;if(l!==""){l="#"+l.substr(2);e('a[href="'+l+'"]').trigger("click")}else{e(".vp-current > .vp-js-menu-goto").click()}e(".vp-js-menu-dropdown").click(function(t){t.preventDefault();var n=e(this),r=n.parent("li"),i=r.siblings("li"),s=n.next("ul");if(r.hasClass("vp-current"))return;i.removeClass("vp-current");r.addClass("vp-current");if(s.children("li.vp-current").exists())s.children("li.vp-current").children("a").click();else s.children("li").first().children("a").click()});for(var c=0;c<o.length;c++){var h=o[c],p=h.bind.split("|"),d=p[0],v=p[1],m=[];v=v.split(/[\s,]+/);for(var g=0;g<v.length;g++){m.push(v[g])}for(var g=0;g<m.length;g++){vp.binding_event(m,g,h,d,".vp-wrap","option")}}for(var c=0;c<u.length;c++){var h=u[c],p=h.bind.split("|"),d=p[0],v=p[1],m=[];v=v.split(/[\s,]+/);for(var g=0;g<v.length;g++){m.push(v[g])}for(var g=0;g<m.length;g++){vp.items_binding_event(m,g,h,d,".vp-wrap","option")}}for(var c=0;c<a.length;c++){var h=a[c],p=h.dep.split("|"),d=p[0],v=p[1],m=[];v=v.split(",");for(var g=0;g<v.length;g++){m.push(v[g])}for(var g=0;g<m.length;g++){vp.dependency_event(m,g,h,d,".vp-wrap")}}e(".vp-js-option-form").bind("submit",function(t){t.preventDefault();vp.tinyMCE_save();e(".vp-js-option-form .vp-field").removeClass("vp-error");e(".validation-notif.vp-error").remove();e(".validation-msg.vp-error").remove();var n=0,r='<em class="validation-notif vp-error"></em>';for(var i=0;i<s.length;i++){var o=s[i];o.nError=0;o.nError=vp.fields_validation_loop(o.fields);if(o.nError>0){var u=e(r),a=e('[href="#'+o.name+'"]'),f=a.parent("li").parent("ul");u.appendTo(a);if(f.hasClass("vp-menu-level-2")){if(f.siblings("a").children(".validation-notif.vp-error").length===0){u.clone().appendTo(f.siblings("a"))}}}n=n+o.nError}if(n>0){return}var l=e(".vp-js-save-loader"),c=e(this).find(".vp-save"),h=e(".vp-js-save-status"),p=e("#vp-option-form"),d=p.serializeArray(),v={action:"vp_ajax_"+vp_opt.name+"_save",option:d,nonce:vp_opt.nonce};c.attr("disabled","disabled");l.stop(true,true).fadeIn(100);e.post(ajaxurl,v,function(e){h.html(e.message);if(e.status){h.addClass("success")}else{h.addClass("failed")}l.stop(true,true).fadeOut(100,function(){h.stop(true,true).fadeIn(100)});setTimeout(function(){c.removeAttr("disabled");h.stop(true,true).fadeOut(1e3,function(){h.removeClass("success").removeClass("failed")})},3e3)},"JSON")});e(".vp-js-restore").bind("click",function(t){t.preventDefault();if(!confirm("The current options will be deleted, do you want to proceed?"))return;var n=e(this),r=n.parent(),i=r.find(".vp-js-status"),s=r.find(".vp-js-loader"),o={action:"vp_ajax_"+vp_opt.name+"_restore",nonce:vp_opt.nonce};n.attr("disabled","disabled");s.fadeIn(100);e.post(ajaxurl,o,function(e){s.fadeOut(0);switch(e.code){case parseInt(vp_opt.SAVE_SUCCESS):i.html(vp_opt.util_msg.restore_success);break;case parseInt(vp_opt.SAVE_NOCHANGES):i.html(vp_opt.util_msg.restore_nochanges);break;case parseInt(vp_opt.SAVE_FAILED):i.html(vp_opt.util_msg.restore_failed+": "+e.message);break}i.fadeIn(100);setTimeout(function(){i.fadeOut(1e3,function(){n.removeAttr("disabled");i.fadeOut(500);if(e.code==parseInt(vp_opt.SAVE_SUCCESS))location.reload()})},2e3)},"JSON")});e("#vp-js-import").bind("click",function(t){t.preventDefault();var n=e("#vp-js-import_text"),r=e("#vp-js-import-status"),i=e("#vp-js-import-loader"),s=e(this),o={action:"vp_ajax_"+vp_opt.name+"_import_option",option:n.val(),nonce:vp_opt.nonce};s.attr("disabled","disabled");i.fadeIn(100);e.post(ajaxurl,o,function(e){i.fadeOut(0);if(e.status){r.html(vp_opt.util_msg.import_success)}else{r.html(vp_opt.util_msg.import_failed+": "+e.message)}r.fadeIn(100);setTimeout(function(){r.fadeOut(1e3,function(){s.removeAttr("disabled");r.fadeOut(500);if(e.status)location.reload()})},2e3)},"JSON")});e("#vp-js-export").bind("click",function(t){t.preventDefault();var n=e("#vp-js-export-status"),r=e("#vp-js-export-loader"),i=e(this),s={action:"vp_ajax_"+vp_opt.name+"_export_option",nonce:vp_opt.nonce};i.attr("disabled","disabled");r.fadeIn(100);e.post(ajaxurl,s,function(t){r.fadeOut(0);if(!e.isEmptyObject(t.option)&&t.status){e("#vp-js-export_text").val(t.option);n.html(vp_opt.util_msg.export_success)}else{n.html(vp_opt.util_msg.export_failed+": "+t.message)}n.fadeIn(100);setTimeout(function(){n.fadeOut(1e3,function(){i.removeAttr("disabled");n.fadeOut(500)})},3e3)},"JSON")});e(".vp-multitextbox").on("click",".vp-js-multitextbox-remove",function(t){t.preventDefault();if(e("#"+e(this).attr("rel-id")+" div").length>1){e(this).prev('input[type="text"]').val("");e(this).parent().slideUp("medium",function(){e(this).remove()})}else{return}});e(".vp-js-multitextbox-add").on("click",function(t){t.preventDefault();var n=e(this).attr("rel-id"),r=e("#"+n+" div:last-child").clone();e("#"+n).append(r);e("#"+n+" div:last-child").removeAttr("style");e("#"+n+' div:last-child input[type="text"]').attr("value","");e("#"+n+' div:last-child input[type="text"]').attr("name",e(this).attr("rel-name"))})})(jQuery)